type: object
required:
  - sentinel_id
  - timestamp
  - severity
  - domain
  - finding
  - object
properties:
  sentinel_id:
    type: string
    description: Sentinel instance identifier
    pattern: "^sentinel-v[0-9]+$"
  timestamp:
    type: string
    format: date-time
    description: ISO 8601 timestamp of alert
  severity:
    type: string
    enum: [P0, P1, P2]
    description: |
      P0: Critical - halt all related tasks, human required
      P1: Warning - pause pipeline, optional notify
      P2: Info - log only
  domain:
    type: string
    enum:
      - backup_integrity
      - restore_validation
      - object_lock
      - checksum
      - schema_validation
      - retention
      - bucket_policy
    description: Security domain of the finding
  finding:
    type: string
    description: Specific finding type
    enum:
      - object_lock_missing
      - object_lock_wrong_mode
      - retention_expired
      - retention_insufficient
      - checksum_mismatch
      - schema_invalid
      - bucket_no_lock
      - manifest_corrupted
      - unauthorized_access
      - policy_violation
  object:
    type: string
    description: S3 object key or resource identifier
  details:
    type: object
    description: Finding-specific details
    properties:
      expected_lock:
        type: string
      actual_lock:
        type: string
        nullable: true
      expected_checksum:
        type: string
      actual_checksum:
        type: string
      retention_days:
        type: integer
      error_message:
        type: string
  checksum_verified:
    type: boolean
    description: Whether checksum was successfully verified
  correlation_id:
    type: string
    description: Links related alerts together
  source_backup_id:
    type: string
    description: Backup ID if applicable
