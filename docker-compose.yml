services:
  ui:
    build: ./services/ui
    container_name: origin-ui
    ports:
      - "8000:8000"
    environment:
      - OPENROUTER_API_KEY=${OPENROUTER_API_KEY}
      - CODEX_URL=http://codex:8000
      - MCP_HUB_URL=http://mcp-hub:8000
    depends_on:
      - codex
      - mcp-hub
    restart: unless-stopped

  codex:
    build: ./services/codex
    container_name: origin-codex
    ports:
      - "8001:8000"
    environment:
      - JWT_SECRET=${JWT_SECRET}
      - REQUIRE_AUTH=true
      - GOOGLE_SERVICE_ACCOUNT_EMAIL=${GOOGLE_SERVICE_ACCOUNT_EMAIL}
      - GOOGLE_SERVICE_ACCOUNT_PRIVATE_KEY=${GOOGLE_SERVICE_ACCOUNT_PRIVATE_KEY}
    restart: unless-stopped

  mcp-hub:
    build: ./services/mcp-hub
    container_name: origin-mcp-hub
    ports:
      - "8002:8000"
    environment:
      - JWT_SECRET=${JWT_SECRET}
      - CODEX_URL=http://codex:8000
      - FIRECRAWL_API_KEY=${FIRECRAWL_API_KEY}
      - SEMRUSH_API_KEY=${SEMRUSH_API_KEY}
      - FS_BASE_PATH=/data
      - MEMORY_PATH=/data/memory
    volumes:
      - mcp-data:/data
      - /var/run/docker.sock:/var/run/docker.sock
    depends_on:
      - codex
    restart: unless-stopped

  vault:
    build: ./services/vault
    container_name: origin-vault
    env_file:
      - .env
    volumes:
      - ./vault:/vault
    restart: unless-stopped

volumes:
  mcp-data:
    name: origin-mcp-data

networks:
  default:
    name: origin-network
